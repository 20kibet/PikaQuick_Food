
<!-- ============================================ -->
<!-- Dashboard/templates/dashboard/edit_food.html -->
<!-- ============================================ -->

{% extends 'base.html' %}

{% block title %}Edit Food Item{% endblock %}

{% block hero %}
<section class="hero-form mb-4">
    <div class="text-center py-4">
        <h1 class="display-5 fw-bold text-white mb-2">
            <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" class="me-2" viewBox="0 0 16 16">
                <path d="M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168l10-10z"/>
            </svg>
            Edit Food Item
        </h1>
        <p class="text-white-50">Update {{ food.name }}</p>
    </div>
</section>

<style>
.hero-form {
    background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
    border-radius: 20px;
    margin-bottom: 2rem;
}
</style>
{% endblock %}

{% block content %}
<div class="container" style="max-width: 800px;">
    <div class="card border-0 shadow-sm rounded-4">
        <div class="card-body p-5">
            <form method="POST" enctype="multipart/form-data">
                {% csrf_token %}
                
                <!-- Current Image Preview -->
                <div class="mb-4 text-center">
                    <label class="form-label fw-bold d-block mb-3">Food Image</label>
                    <div class="image-upload-wrapper">
                        <input type="file" name="image" id="imageInput" accept="image/*" class="d-none">
                        <label for="imageInput" class="image-preview-box">
                            <div id="imagePreview" class="preview-content">
                                {% if food.image %}
                                    <img src="{{ food.image.url }}" alt="{{ food.name }}">
                                {% else %}
                                    <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" fill="#ccc" viewBox="0 0 16 16">
                                        <path d="M6.002 5.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"/>
                                        <path d="M2.002 1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2h-12zm12 1a1 1 0 0 1 1 1v6.5l-3.777-1.947a.5.5 0 0 0-.577.093l-3.71 3.71-2.66-1.772a.5.5 0 0 0-.63.062L1.002 12V3a1 1 0 0 1 1-1h12z"/>
                                    </svg>
                                    <p class="mt-3 mb-0 text-muted">Click to upload image</p>
                                {% endif %}
                            </div>
                        </label>
                        <small class="text-muted d-block mt-2">Click to change image</small>
                    </div>
                </div>

                <!-- Name -->
                <div class="mb-4">
                    <label for="name" class="form-label fw-bold">
                        Food Name <span class="text-danger">*</span>
                    </label>
                    <input type="text" name="name" id="name" class="form-control form-control-lg" value="{{ food.name }}" required>
                </div>

                <!-- Description -->
                <div class="mb-4">
                    <label for="description" class="form-label fw-bold">Description</label>
                    <textarea name="description" id="description" class="form-control" rows="4">{{ food.description }}</textarea>
                </div>

                <!-- Price and Category Row -->
                <div class="row mb-4">
                    <div class="col-md-6">
                        <label for="price" class="form-label fw-bold">
                            Price (Ksh) <span class="text-danger">*</span>
                        </label>
                        <div class="input-group input-group-lg">
                            <span class="input-group-text">Ksh</span>
                            <input type="number" name="price" id="price" class="form-control" value="{{ food.price }}" step="0.01" min="0" required>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <label for="category" class="form-label fw-bold">Category</label>
                        <select name="category" id="category" class="form-select form-select-lg">
                            <option value="">Select Category</option>
                            <option value="pizza" {% if food.category == 'pizza' %}selected{% endif %}>Pizza</option>
                            <option value="burger" {% if food.category == 'burger' %}selected{% endif %}>Burgers</option>
                            <option value="salad" {% if food.category == 'salad' %}selected{% endif %}>Salads</option>
                            <option value="pasta" {% if food.category == 'pasta' %}selected{% endif %}>Pasta</option>
                            <option value="drinks" {% if food.category == 'drinks' %}selected{% endif %}>Drinks</option>
                            <option value="dessert" {% if food.category == 'dessert' %}selected{% endif %}>Desserts</option>
                            <option value="appetizer" {% if food.category == 'appetizer' %}selected{% endif %}>Appetizers</option>
                            <option value="main" {% if food.category == 'main' %}selected{% endif %}>Main Course</option>
                        </select>
                    </div>
                </div>

                <!-- Availability -->
                <div class="mb-4">
                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" name="available" id="available" {% if food.available %}checked{% endif %} style="width: 3rem; height: 1.5rem;">
                        <label class="form-check-label ms-2 fw-bold" for="available">
                            Available for Order
                        </label>
                        <p class="text-muted small mb-0 ms-2">Toggle to mark as out of stock</p>
                    </div>
                </div>

                <!-- Buttons -->
                <div class="d-flex gap-3 mt-5">
                    <button type="submit" class="btn btn-primary btn-lg rounded-pill flex-fill">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="me-2" viewBox="0 0 16 16">
                            <path d="M12.736 3.97a.733.733 0 0 1 1.047 0c.286.289.29.756.01 1.05L7.88 12.01a.733.733 0 0 1-1.065.02L3.217 8.384a.757.757 0 0 1 0-1.06.733.733 0 0 1 1.047 0l3.052 3.093 5.4-6.425a.247.247 0 0 1 .02-.022Z"/>
                        </svg>
                        Save Changes
                    </button>
                    <a href="{% url 'dashboard:dashboard_home' %}" class="btn btn-outline-secondary btn-lg rounded-pill flex-fill">
                        Cancel
                    </a>
                </div>
            </form>
        </div>
    </div>
</div>

<style>
.image-upload-wrapper {
    max-width: 400px;
    margin: 0 auto;
}
.image-preview-box {
    display: block;
    width: 100%;
    height: 250px;
    border: 3px dashed #dee2e6;
    border-radius: 20px;
    cursor: pointer;
    transition: all 0.3s ease;
    overflow: hidden;
}
.image-preview-box:hover {
    border-color: #007bff;
    background-color: #f8f9fa;
}
.preview-content {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100%;
}
#imagePreview img {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
}
</style>

<script>
// Image preview
document.getElementById('imageInput').addEventListener('change', function(e) {
    const file = e.target.files[0];
    if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
            document.getElementById('imagePreview').innerHTML = 
                '<img src="' + e.target.result + '" alt="Preview">';
        }
        reader.readAsDataURL(file);
    }
});
</script>
{% endblock %}