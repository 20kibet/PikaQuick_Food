{% extends 'base.html' %}

{% block title %}Order Food{% endblock %}

{% block hero %}
<!-- Hero Section with Search -->
<section class="hero-order mb-4">
    <div class="text-center py-5">
        <h1 class="display-4 fw-bold text-dark mb-3">What are you craving today?</h1>
        <p class="lead text-muted mb-4">Fresh food delivered fast to your doorstep</p>
        
        <!-- Search Bar -->
        <div class="row justify-content-center">
            <div class="col-md-8 col-lg-6">
                <form method="GET" action="{% url 'product_list' %}">
                    <div class="input-group input-group-lg shadow-lg">
                        <input type="text" class="form-control border-0" name="search" placeholder="Search for dishes, restaurants..." id="searchInput" value="{{ request.GET.search }}">
                        <button class="btn btn-custom-primary px-4" type="submit">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                                <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
                            </svg>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</section>

<style>
.btn-custom-primary {
    background-color: #dc3545;
    border-color: #dc3545;
    color: white;
}
.btn-custom-primary:hover {
    background-color: #c82333;
    border-color: #c82333;
    color: white;
}
.hero-order {
    background: linear-gradient(135deg, #ffeaa7 0%, #fdcb6e 100%);
    border-radius: 20px;
    margin-bottom: 2rem;
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
}
</style>
{% endblock %}

{% block content %}
<!-- Category Filter -->
<section class="mb-5">
    <h4 class="mb-4 fw-bold text-dark">
        <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="#dc3545" class="bi bi-grid-3x3-gap-fill me-2" viewBox="0 0 16 16">
            <path d="M1 2a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2zm5 0a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V2zm5 0a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1V2zM1 7a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V7zm5 0a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V7zm5 0a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1V7zM1 12a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1v-2zm5 0a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1v-2zm5 0a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1v-2z"/>
        </svg>
        Browse by Category
    </h4>
    <div class="d-flex gap-3 flex-wrap category-buttons">
        <a href="{% url 'home' %}" class="btn btn-outline-danger btn-category {% if not request.GET.category %}active{% endif %}">
            <span class="me-1">üçΩÔ∏è</span> All
        </a>
        <a href="{% url 'product_list' %}?category=pizza" class="btn btn-outline-danger btn-category">
            <span class="me-1">üçï</span> Pizza
        </a>
        <a href="{% url 'product_list' %}?category=burger" class="btn btn-outline-danger btn-category">
            <span class="me-1">üçî</span> Burgers
        </a>
        <a href="{% url 'product_list' %}?category=salad" class="btn btn-outline-danger btn-category">
            <span class="me-1">ü•ó</span> Salads
        </a>
        <a href="{% url 'product_list' %}?category=taco" class="btn btn-outline-danger btn-category">
            <span class="me-1">üåÆ</span> Tacos
        </a>
        <a href="{% url 'product_list' %}?category=noodles" class="btn btn-outline-danger btn-category">
            <span class="me-1">üçú</span> Noodles
        </a>
        <a href="{% url 'product_list' %}?category=dessert" class="btn btn-outline-danger btn-category">
            <span class="me-1">üç∞</span> Desserts
        </a>
        <a href="{% url 'product_list' %}?category=drinks" class="btn btn-outline-danger btn-category">
            <span class="me-1">ü•§</span> Drinks
        </a>
    </div>
</section>

<!-- Popular Menu Items from Database -->
<section class="mb-5">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h4 class="fw-bold mb-0 text-dark">
            <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="#dc3545" class="bi bi-trophy-fill me-2" viewBox="0 0 16 16">
                <path d="M2.5.5A.5.5 0 0 1 3 0h10a.5.5 0 0 1 .5.5c0 .538-.012 1.05-.034 1.536a3 3 0 1 1-1.133 5.89c-.79 1.865-1.878 2.777-2.833 3.011v2.173l1.425.356c.194.048.377.135.537.255L13.3 15.1a.5.5 0 0 1-.3.9H3a.5.5 0 0 1-.3-.9l1.838-1.379c.16-.12.343-.207.537-.255L6.5 13.11v-2.173c-.955-.234-2.043-1.146-2.833-3.012a3 3 0 1 1-1.132-5.89A33.076 33.076 0 0 1 2.5.5zm.099 2.54a2 2 0 0 0 .72 3.935c-.333-1.05-.588-2.346-.72-3.935zm10.083 3.935a2 2 0 0 0 .72-3.935c-.133 1.59-.388 2.885-.72 3.935z"/>
            </svg>
            Popular Right Now
        </h4>
        <a href="{% url 'product_list' %}" class="text-danger text-decoration-none fw-semibold fs-6">
            View All Menu
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-arrow-right ms-1" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8z"/>
            </svg>
        </a>
    </div>
    
    <div class="row g-4" id="foodItems">
        {% if foods %}
            {% for food in foods %}
            <div class="col-xl-3 col-lg-4 col-md-6">
                <div class="card h-100 food-card border-0 shadow-sm">
                    <div class="position-relative overflow-hidden">
                        {% if food.image %}
                            <img src="{{ food.image.url }}" class="card-img-top food-img" alt="{{ food.name }}">
                        {% else %}
                            <img src="https://images.unsplash.com/photo-1546069901-ba9599a7e63c?auto=format&fit=crop&w=400&q=80" class="card-img-top food-img" alt="{{ food.name }}">
                        {% endif %}
                        
                        {% if food.is_available %}
                            <span class="badge bg-success position-absolute top-0 end-0 m-3 px-3 py-2">Available</span>
                        {% else %}
                            <span class="badge bg-secondary position-absolute top-0 end-0 m-3 px-3 py-2">Out of Stock</span>
                        {% endif %}
                        
                        <div class="food-overlay">
                            <button class="btn btn-light btn-sm rounded-circle">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-heart" viewBox="0 0 16 16">
                                    <path d="m8 2.748-.717-.737C5.6.281 2.514.878 1.4 3.053c-.523 1.023-.641 2.5.314 4.385.92 1.815 2.834 3.989 6.286 6.357 3.452-2.368 5.365-4.542 6.286-6.357.955-1.886.838-3.362.314-4.385C13.486.878 10.4.28 8.717 2.01L8 2.748zM8 15C-7.333 4.868 3.279-3.04 7.824 1.143c.06.055.119.112.176.171a3.12 3.12 0 0 1 .176-.17C12.72-3.042 23.333 4.867 8 15z"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                    <div class="card-body p-3">
                        <h6 class="card-title fw-bold mb-2">{{ food.name }}</h6>
                        <p class="card-text text-muted small mb-3">{{ food.description|truncatewords:10 }}</p>
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <div class="rating">
                                <span class="text-warning">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</span>
                                <span class="text-muted small ms-1">({{ food.id }})</span>
                            </div>
                        </div>
                        <div class="d-flex justify-content-between align-items-center">
                            <span class="fw-bold text-danger fs-5">Ksh {{ food.price }}</span>
                            {% if food.is_available %}
                                {% if user.is_authenticated %}
                                    <form method="POST" action="{% url 'add_to_cart' food.id %}" class="d-inline">
                                        {% csrf_token %}
                                        <button type="submit" class="btn btn-custom-primary btn-sm px-3">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-plus-lg me-1" viewBox="0 0 16 16">
                                                <path fill-rule="evenodd" d="M8 2a.5.5 0 0 1 .5.5v5h5a.5.5 0 0 1 0 1h-5v5a.5.5 0 0 1-1 0v-5h-5a.5.5 0 0 1 0-1h5v-5A.5.5 0 0 1 8 2Z"/>
                                            </svg>
                                            Add
                                        </button>
                                    </form>
                                {% else %}
                                    <a href="{% url 'login' %}" class="btn btn-custom-primary btn-sm px-3">
                                        Login to Add
                                    </a>
                                {% endif %}
                            {% else %}
                                <button class="btn btn-secondary btn-sm px-3" disabled>
                                    Unavailable
                                </button>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        {% else %}
            <div class="col-12 text-center py-5">
                <svg xmlns="http://www.w3.org/2000/svg" width="80" height="80" fill="#dc3545" class="bi bi-basket mb-3" viewBox="0 0 16 16">
                    <path d="M5.757 1.071a.5.5 0 0 1 .172.686L3.383 6h9.234L10.07 1.757a.5.5 0 1 1 .858-.514L13.783 6H15a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1v4.5a2.5 2.5 0 0 1-2.5 2.5h-9A2.5 2.5 0 0 1 1 13.5V9a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h1.217L4.07 1.243a.5.5 0 0 1 .686-.172zM2 9v4.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V9H2zM1 7v1h14V7H1zm3 3a.5.5 0 0 1 .5.5v3a.5.5 0 0 1-1 0v-3A.5.5 0 0 1 4 10zm2 0a.5.5 0 0 1 .5.5v3a.5.5 0 0 1-1 0v-3A.5.5 0 0 1 6 10zm2 0a.5.5 0 0 1 .5.5v3a.5.5 0 0 1-1 0v-3A.5.5 0 0 1 8 10zm2 0a.5.5 0 0 1 .5.5v3a.5.5 0 0 1-1 0v-3a.5.5 0 0 1 .5-.5zm2 0a.5.5 0 0 1 .5.5v3a.5.5 0 0 1-1 0v-3a.5.5 0 0 1 .5-.5z"/>
                </svg>
                <h3 class="text-muted">No food items available yet</h3>
                <p class="text-muted">Check back soon for delicious options!</p>
                {% if user.is_staff %}
                    <a href="{% url 'dashboard:add_food' %}" class="btn btn-custom-primary">Add Your First Item</a>
                {% endif %}
            </div>
        {% endif %}
    </div>
</section>

<!-- Why Choose Us Section -->
<section class="my-5 py-5 bg-light rounded-4">
    <div class="row text-center g-4">
        <div class="col-md-3 col-sm-6">
            <div class="feature-icon mb-3">
                <svg xmlns="http://www.w3.org/2000/svg" width="56" height="56" fill="#dc3545" viewBox="0 0 16 16">
                    <path d="M0 3.5A1.5 1.5 0 0 1 1.5 2h9A1.5 1.5 0 0 1 12 3.5V5h1.02a1.5 1.5 0 0 1 1.17.563l1.481 1.85a1.5 1.5 0 0 1 .329.938V10.5a1.5 1.5 0 0 1-1.5 1.5H14a2 2 0 1 1-4 0H5a2 2 0 1 1-3.998-.085A1.5 1.5 0 0 1 0 10.5v-7zm1.294 7.456A1.999 1.999 0 0 1 4.732 11h5.536a2.01 2.01 0 0 1 .732-.732V3.5a.5.5 0 0 0-.5-.5h-9a.5.5 0 0 0-.5.5v7a.5.5 0 0 0 .294.456zM12 10a2 2 0 0 1 1.732 1h.768a.5.5 0 0 0 .5-.5V8.35a.5.5 0 0 0-.11-.312l-1.48-1.85A.5.5 0 0 0 13.02 6H12v4zm-9 1a1 1 0 1 0 0 2 1 1 0 0 0 0-2zm9 0a1 1 0 1 0 0 2 1 1 0 0 0 0-2z"/>
                </svg>
            </div>
            <h5 class="fw-bold mb-2">Fast Delivery</h5>
            <p class="text-muted small mb-0">Get your food in 30 minutes or less</p>
        </div>
        <div class="col-md-3 col-sm-6">
            <div class="feature-icon mb-3">
                <svg xmlns="http://www.w3.org/2000/svg" width="56" height="56" fill="#dc3545" viewBox="0 0 16 16">
                    <path d="M12.166 8.94c-.524 1.062-1.234 2.12-1.96 3.07A31.493 31.493 0 0 1 8 14.58a31.481 31.481 0 0 1-2.206-2.57c-.726-.95-1.436-2.008-1.96-3.07C3.304 7.867 3 6.862 3 6a5 5 0 0 1 10 0c0 .862-.305 1.867-.834 2.94zM8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10z"/>
                    <path d="M8 8a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm0 1a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
                </svg>
            </div>
            <h5 class="fw-bold mb-2">Track Order</h5>
            <p class="text-muted small mb-0">Real-time tracking of your delivery</p>
        </div>
        <div class="col-md-3 col-sm-6">
            <div class="feature-icon mb-3">
                <svg xmlns="http://www.w3.org/2000/svg" width="56" height="56" fill="#dc3545" viewBox="0 0 16 16">
                    <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                    <path d="M10.97 4.97a.235.235 0 0 0-.02.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-1.071-1.05z"/>
                </svg>
            </div>
            <h5 class="fw-bold mb-2">Fresh Quality</h5>
            <p class="text-muted small mb-0">Only the freshest ingredients used</p>
        </div>
        <div class="col-md-3 col-sm-6">
            <div class="feature-icon mb-3">
                <svg xmlns="http://www.w3.org/2000/svg" width="56" height="56" fill="#dc3545" viewBox="0 0 16 16">
                    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>
                    <path d="M7.646 1.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708L8.5 2.707V11.5a.5.5 0 0 1-1 0V2.707L5.354 4.854a.5.5 0 1 1-.708-.708l3-3z"/>
                </svg>
            </div>
            <h5 class="fw-bold mb-2">Easy Payment</h5>
            <p class="text-muted small mb-0">Multiple secure payment options</p>
        </div>
    </div>
</section>

<style>
/* Food Cards */
.food-card {
    transition: all 0.3s ease;
    border-radius: 15px;
    overflow: hidden;
}

.food-card:hover {
    transform: translateY(-8px);
    box-shadow: 0 8px 25px rgba(220, 53, 69, 0.15) !important;
}

.food-card .food-img {
    height: 220px;
    object-fit: cover;
    transition: transform 0.5s ease;
}

.food-card:hover .food-img {
    transform: scale(1.1);
}

.food-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.3);
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0;
    transition: opacity 0.3s ease;
}

.food-card:hover .food-overlay {
    opacity: 1;
}

/* Category Buttons */
.btn-category {
    padding: 10px 20px;
    font-weight: 500;
    border-radius: 25px;
    transition: all 0.3s ease;
    border-width: 2px;
    text-decoration: none;
}

.btn-category:hover, .btn-category.active {
    background-color: #dc3545;
    color: white;
    border-color: #dc3545;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(220, 53, 69, 0.3);
}

/* Feature Icons */
.feature-icon {
    display: inline-block;
    padding: 15px;
    background: rgba(220, 53, 69, 0.1);
    border-radius: 50%;
    transition: all 0.3s ease;
}

.feature-icon:hover {
    transform: scale(1.1);
    background: rgba(220, 53, 69, 0.2);
}
</style>

{% endblock %}